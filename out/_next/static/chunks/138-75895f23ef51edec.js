"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{59138:function(e,n,t){t.d(n,{Z:function(){return N}});var i=t(47568),a=t(10092),s=t(85893),r=t(67294),o=t(12660),l=t(2734),c=t(41796),u=t(5616),d=t(15861),p=t(25662),h=t(86886),m=t(66242),y=t(83965),x=t(51233),g=t(2391),f=t(45697),b=t.n(f),j=t(78262),w=t(94054),Z=t(33841),v=t(90089),T=t(87109),C=t(57922),S=t(21737),M=t(93946),D=t(38043),k=t(83784),B=t(58805),W=t(95537),_=t(37526),R=t(8987),F=t(50231),A=t(82175),E=t(74231),O=E.Ry({newBeneficiary:E.Z_().min(20,"Enter correct wallet address!").required("Please specify new beneficiary address").matches(/0x[a-fA-F0-9]{40}/,"Enter correct wallet address!")}),z=function(e){var n,t=e.beneficiaryOpen,o=e.beneficiaryClose,l=e.contract,c=e.account,p=(0,r.useState)(!1),m=p[0],y=p[1],x=(0,A.TA)({initialValues:{newBeneficiary:""},validationSchema:O,onSubmit:function(e){console.log(e),y(!0),function(){g.apply(this,arguments)}()}});function g(){return(g=(0,i.Z)(function(){var e,n;return(0,a.__generator)(this,function(n){switch(n.label){case 0:e=x.values.newBeneficiary,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,l.methods.setBeneficiary(e).send({from:c})];case 2:return n.sent(),alert("Fundraiser Beneficiary Changed"),y(!1),[3,4];case 3:return alert(n.sent()),y(!1),[3,4];case 4:return y(!1),[2]}})})).apply(this,arguments)}return(0,s.jsx)(j.Z,{onClose:o,open:t,maxWidth:"sm",sx:{"& .MuiPaper-root":{borderRadius:4}},children:(0,s.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",paddingY:{xs:4,sm:10},paddingX:{xs:4,sm:12}},children:[(0,s.jsx)(F.Z,{sx:{fontSize:50}}),(0,s.jsx)(d.Z,{align:"center",children:(0,s.jsxs)(d.Z,{component:"span",fontWeight:700,children:["Change beneficiary address"," "]})}),(0,s.jsx)("form",{onSubmit:x.handleSubmit,children:(0,s.jsxs)(h.ZP,{container:!0,spacing:2,sx:{marginY:4},children:[(0,s.jsx)(h.ZP,{item:!0,xs:12,children:(0,s.jsx)(_.Z,{label:"Enter new beneficiary address",variant:"outlined",name:"newBeneficiary",fullWidth:!0,onChange:x.handleChange,value:null===(n=x.values)||void 0===n?void 0:n.newBeneficiary,error:x.touched.newBeneficiary&&Boolean(x.errors.newBeneficiary),helperText:x.touched.newBeneficiary&&x.errors.newBeneficiary})}),(0,s.jsx)(h.ZP,{item:!0,xs:12,children:(0,s.jsx)(R.Z,{size:"large",variant:"contained",type:"submit",loading:m,fullWidth:!0,children:"Change"})})]})}),(0,s.jsx)(d.Z,{align:"center",sx:{textDecoration:"underline",cursor:"pointer"},onClick:o,children:"Cancel"})]})})};z.propTypes={beneficiaryClose:b().func.isRequired,beneficiaryOpen:b().bool.isRequired,contract:b().object.isRequired,account:b().string};var I=function(e){var n,t=e.onClose,o=e.open,m=e.web3,y=e.contract,g=e.account,f=e.exchangeRate,b=e.image,_=e.name,F=e.description,A=e.goalAmount,E=e.totalDonations,O=e.totalDonationsEth,I=e.withdrawFunds,P=e.isOwner,q=e.renderDonationsList,$=(0,r.useState)(!1),L=$[0],Y=$[1],H=(0,l.Z)(),N=(0,r.useState)(5),U=N[0],X=N[1],V=(0,r.useState)(!1),G=V[0],J=V[1],K=(0,r.useState)(!1),Q=K[0],ee=K[1],en=(n=(0,i.Z)(function(){var e,n,t;return(0,a.__generator)(this,function(i){switch(i.label){case 0:ee(!0),e=U/f,n=m.utils.toWei(e.toString()),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,y.methods.donate().send({from:g,value:n,gas:65e4})];case 2:return i.sent(),J(!0),[3,4];case 3:return t=i.sent(),console.log(t),alert("Error donating"),ee(!1),[3,4];case 4:return ee(!1),[2]}})}),function(){return n.apply(this,arguments)});return(0,s.jsx)(j.Z,{onClose:t,open:o,maxWidth:"lg",children:(0,s.jsxs)(u.Z,{paddingY:{xs:1,sm:2},paddingX:{xs:2,sm:4},children:[(0,s.jsx)(u.Z,{paddingY:{xs:1,sm:2},display:"flex",justifyContent:"flex-end",children:(0,s.jsx)(u.Z,{component:"svg",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:24,height:24,onClick:t,sx:{cursor:"pointer"},children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,s.jsx)(u.Z,{paddingY:2,children:(0,s.jsxs)(h.ZP,{container:!0,spacing:{xs:2,md:4},children:[(0,s.jsx)(h.ZP,{item:!0,xs:12,md:6,children:(0,s.jsxs)(u.Z,{children:[(0,s.jsx)(u.Z,{sx:{width:1,height:"auto","& img":{width:1,height:1,objectFit:"cover",borderRadius:2}},children:(0,s.jsx)("img",{src:b,alt:_})}),q]})}),(0,s.jsx)(h.ZP,{item:!0,xs:12,md:6,children:(0,s.jsxs)(u.Z,{children:[(0,s.jsx)(u.Z,{padding:1,display:"inline-flex",borderRadius:1,bgcolor:H.palette.success.light,marginBottom:1,children:(0,s.jsxs)(d.Z,{sx:{color:"common.white",lineHeight:1},children:["Goal: $",A]})}),(0,s.jsx)(d.Z,{variant:"h5",fontWeight:700,gutterBottom:!0,children:_}),(0,s.jsx)(d.Z,{variant:"subtitle2",color:"text.secondary",children:F}),(0,s.jsxs)(u.Z,{marginTop:2,display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,s.jsxs)(d.Z,{children:["Raised:"," ",(0,s.jsxs)(d.Z,{component:"span",fontWeight:700,children:["$",E||0," ≈ ",O," ETH"]})]}),(0,s.jsx)(u.Z,{display:"flex",alignItems:"center",padding:1,borderRadius:1,bgcolor:H.palette.error.light,children:(0,s.jsxs)(d.Z,{variant:"caption",sx:{color:"common.white"},marginLeft:.5,children:["Required: $",E<A?A-E:0]})})]}),(0,s.jsxs)(u.Z,{marginTop:2,children:[(0,s.jsxs)(d.Z,{children:["Donate:",(0,s.jsxs)(d.Z,{component:"span",fontWeight:700,children:["$",U," ≈ ",parseFloat(U/f).toFixed(4)," ","ETH"]})]}),(0,s.jsxs)(x.Z,{marginTop:1,direction:{xs:"column",sm:"row"},spacing:2,children:[[10,15,20].map(function(e){return(0,s.jsx)(u.Z,{onClick:function(){return X(e)},sx:{borderRadius:1,padding:1,border:"2px solid ".concat(U===e?H.palette.primary.main:H.palette.divider),cursor:"pointer"},children:(0,s.jsxs)(d.Z,{children:["$",e]})},e)}),(0,s.jsxs)(w.Z,{variant:"standard",children:[(0,s.jsx)(Z.Z,{htmlFor:"standard-adornment-amount",children:"Amount"}),(0,s.jsx)(v.Z,{id:"standard-adornment-amount",value:U,onChange:function(e){return X(e.target.value)},startAdornment:(0,s.jsx)(T.Z,{position:"start",children:"$"})})]})]})]}),(0,s.jsxs)(x.Z,{marginTop:3,direction:{xs:"column",sm:"row"},spacing:2,children:[(0,s.jsx)(R.Z,{variant:"contained",color:"primary",size:"large",startIcon:(0,s.jsx)(D.Z,{}),loading:Q,onClick:en,fullWidth:!0,children:"Donate"}),P&&(0,s.jsx)(p.Z,{color:"primary",startIcon:(0,s.jsx)(k.Z,{}),size:"large",fullWidth:!0,sx:{bgcolor:(0,c.Fq)(H.palette.primary.light,.1)},onClick:function(){return Y(!0)},children:"Edit Beneficiary"}),(0,s.jsx)(z,{beneficiaryClose:function(){return Y(!1)},beneficiaryOpen:L,account:g,contract:y}),P&&(0,s.jsxs)(p.Z,{color:"primary",startIcon:(0,s.jsx)(B.Z,{}),size:"large",fullWidth:!0,sx:{bgcolor:(0,c.Fq)(H.palette.primary.light,.1)},onClick:I,children:[" ","Withdraw"]})]}),(0,s.jsx)(C.Z,{in:G,children:(0,s.jsx)(S.Z,{severity:"success",action:(0,s.jsx)(M.Z,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){J(!1)},children:(0,s.jsx)(W.Z,{fontSize:"inherit"})}),sx:{mb:2},children:"Donation made successfully!"})})]})})]})})]})})};I.propTypes={onClose:b().func,open:b().bool,web3:b().object,account:b().string,contract:b().object,exchangeRate:b().number,totalDonations:b().string,totalDonationsEth:b().string,image:b().string,name:b().string,description:b().string,goalAmount:b().number,renderDonationsList:b().func};var P=t(37918),q=t.n(P),$=t(92003),L=t.n($),Y=JSON.parse('{"Mt":[{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"string","name":"_image","type":"string"},{"internalType":"string","name":"_description","type":"string"},{"internalType":"uint256","name":"_goalAmount","type":"uint256"},{"internalType":"address payable","name":"_beneficiary","type":"address"},{"internalType":"address","name":"_custodian","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"donor","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"DonationReceived","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"Withdraw","type":"event"},{"stateMutability":"payable","type":"fallback"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"_donations","outputs":[{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"uint256","name":"date","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"beneficiary","outputs":[{"internalType":"address payable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"description","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"donationsCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"goalAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"image","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"totalDonations","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address payable","name":"_beneficiary","type":"address"}],"name":"setBeneficiary","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"myDonationsCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"donate","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"myDonations","outputs":[{"internalType":"uint256[]","name":"values","type":"uint256[]"},{"internalType":"uint256[]","name":"dates","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),H=t(52668),N=function(e){var n,t=e.fundraiser,f=(0,l.Z)(),b=(0,r.useState)(!1),j=b[0],w=b[1],Z=(0,r.useState)(null),v=Z[0],T=Z[1],C=(0,r.useState)(null),S=C[0],M=C[1],D=(0,r.useState)(""),k=D[0],B=D[1],W=(0,r.useState)(null),_=W[0],R=W[1],F=(0,r.useState)(null),A=F[0],E=F[1],O=(0,r.useState)(null),z=O[0],P=O[1],$=(0,r.useState)(null),N=$[0],U=$[1],X=(0,r.useState)(null),V=X[0],G=X[1],J=(0,r.useState)([]),K=J[0],Q=J[1],ee=(0,r.useState)(null),en=ee[0],et=ee[1],ei=(0,r.useState)(null),ea=ei[0],es=ei[1],er=(0,r.useState)(!1),eo=er[0],el=er[1],ec=(0,r.useState)(null),eu=ec[0];ec[1],(0,r.useEffect)(function(){t&&ep(t)},[t]);var ed,ep=(n=(0,i.Z)(function(e){var n,t,i,s,r,o,l,c,u,d;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,11,,12]),n=e,[4,L()()];case 1:return t=a.sent(),[4,(i=new(q())(t)).eth.getAccounts()];case 2:return s=a.sent(),console.log("accounts---",s),r=new i.eth.Contract(Y.Mt,n),T(i),G(r),Q(s),[4,r.methods.name().call()];case 3:return R.apply(void 0,[a.sent()]),[4,r.methods.image().call()];case 4:return B.apply(void 0,[a.sent()]),[4,r.methods.description().call()];case 5:return M.apply(void 0,[a.sent()]),[4,r.methods.goalAmount().call()];case 6:return E.apply(void 0,[a.sent()]),console.log("---------data--------"),console.log(_,k,S,A),[4,r.methods.totalDonations().call()];case 7:return o=a.sent(),[4,H.price("ETH",["USD"]).then(function(e){en=e.USD,et(e.USD)}).catch(console.error)];case 8:return a.sent(),U(parseFloat(l=i.utils.fromWei(i.utils.toBN(o),"ether")).toFixed(4)),P((en*l).toFixed(2)),[4,r.methods.myDonations().call({from:K[0]})];case 9:return es(a.sent()),K[0],[4,r.methods.owner().call()];case 10:return a.sent()===K[0]&&el(!0),[3,12];case 11:return d=a.sent(),console.error(d),[3,12];case 12:return[2]}})}),function(e){return n.apply(this,arguments)});return(0,i.Z)(function(){return(0,a.__generator)(this,function(e){switch(e.label){case 0:return[4,V.methods.setBeneficiary(eu).send({from:K[0]})];case 1:return e.sent(),alert("Fundraiser Beneficiary Changed"),w(!1),[2]}})}),(0,s.jsx)(h.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsxs)(u.Z,{display:"block",width:1,height:1,children:[(0,s.jsxs)(m.Z,{sx:{width:1,height:1,display:"flex",flexDirection:"column",boxShadow:"none",bgcolor:"transparent",backgroundImage:"none"},children:[(0,s.jsx)(y.Z,{title:_,image:k,sx:{position:"relative",height:320,overflow:"hidden",borderRadius:2,filter:"dark"===f.palette.mode?"brightness(0.7)":"none"},onClick:function(){return w(!0)},children:(0,s.jsx)(x.Z,{direction:"row",spacing:1,sx:{position:"absolute",top:"auto",bottom:0,left:0,right:0,padding:2},children:(0,s.jsx)(u.Z,{sx:{bgcolor:f.palette.success.light,paddingY:"4px",paddingX:"8px",borderRadius:1,display:"flex",alignItems:"center"},children:(0,s.jsxs)(d.Z,{variant:"caption",fontWeight:700,sx:{color:f.palette.common.white,lineHeight:1},children:["$",z||"0"," raised"]})})})}),(0,s.jsx)(u.Z,{marginTop:1,children:(0,s.jsx)(d.Z,{fontWeight:700,children:_})}),(0,s.jsx)(x.Z,{marginTop:1,spacing:1,direction:"row",children:(0,s.jsx)(p.Z,{color:"primary",size:"large",startIcon:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:20,height:20,children:[(0,s.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),fullWidth:!0,sx:{bgcolor:(0,c.Fq)(f.palette.primary.light,.1)},onClick:function(){return w(!0)},children:"View"})})]}),(0,s.jsx)(I,{open:j,onClose:function(){return w(!1)},web3:v,contract:V,exchangeRate:en,totalDonations:z,totalDonationsEth:N,image:k,name:_,description:S,goalAmount:A,account:K[0],isOwner:eo,renderDonationsList:function(){if(null===ea)return null;var e=ea.length,n=[];for(t=0;t<e;t++){var t,i=en*v.utils.fromWei(ea.values[t],"ether"),a=ea.dates[t];n.push({donationAmount:i.toFixed(2),date:a}),console.log("<<<<",n)}return n.map(function(e){return(0,s.jsxs)(u.Z,{children:[(0,s.jsxs)(d.Z,{component:"span",fontWeight:700,children:["$",e.donationAmount]}),(0,s.jsx)(o.rU,{to:{pathname:"/receipt",state:{fund:_,donation:e.donationAmount,date:e.date}},children:(0,s.jsx)(p.Z,{startIcon:(0,s.jsx)(g.Z,{}),variant:"contained",color:"primary",children:"Receipt"})})]})})}()},t)]})})}}}]);